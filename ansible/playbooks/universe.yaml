- hosts: localhost
  connection: local
  vars:
    - rosdistro: galactic
    - rmw_implementation: rmw_cyclonedds_cpp
    - cuda_version: 11-4
    - cudnn_version: 8.2.4.15-1+cuda11.4
    - tensorrt_version: 8.2.4-1+cuda11.4
  vars_prompt:
    - name: install_nvidia
      prompt: |-
        [Warning] Some Autoware components depend on the CUDA, cuDNN and TensorRT NVIDIA libraries which have end-user license agreements that should be reviewed before installation.
        Proceed? [y/N]
      private: false
  pre_tasks:
    - name: Show a warning if the NVIDIA libraries will not be installed
      ansible.builtin.pause:
        seconds: 10
        prompt: |
          [Warning] Skipping installation of NVIDIA libraries. Please manually install them if you plan to use dependent components.
      when: install_nvidia != 'y'
  roles:
    # Core
    - role: autoware.dev_env.autoware_core
    - role: autoware.dev_env.docker
    - role: autoware.dev_env.pre_commit
    - role: autoware.dev_env.ros2
    - role: autoware.dev_env.ros2_dev_tools
    - role: autoware.dev_env.rmw_implementation

    # Universe
    - role: autoware.dev_env.autoware_universe
    - role: autoware.dev_env.cuda
      when: install_nvidia == 'y'
    - role: autoware.dev_env.pacmod
    - role: autoware.dev_env.tensorrt
      when: install_nvidia == 'y'
